# -*- coding: utf-8 -*-
"""Preparing_Dataset.ipynb

Automatically generated by Colab.

Original file is located at
    https://colab.research.google.com/drive/1zm9_rBo7BWEYGW3rFfWSiywZgMUpBWxE
"""

!pip install datasets

from datasets import load_dataset

dataset = load_dataset("QuyenAnhDE/Diseases_Symptoms")
data = dataset['train']
print(data[0])

import pandas as pd
df=pd.DataFrame(dataset['train'])
print(df.head())

!huggingface-cli login

from transformers import AutoTokenizer, AutoModelForSeq2SeqLM

model_name = "google/flan-t5-base"
tokenizer = AutoTokenizer.from_pretrained(model_name)
model = AutoModelForSeq2SeqLM.from_pretrained(model_name)

def get_specialist(disease, symptoms, treatments):
    prompt = f"Given the disease '{disease}' with symptoms '{symptoms}' and treatments '{treatments}', suggest a medical specialist to consult."
    inputs = tokenizer(prompt, return_tensors="pt", truncation=True)
    outputs = model.generate(**inputs, max_new_tokens=30)
    return tokenizer.decode(outputs[0], skip_special_tokens=True)

df["Specialist"] = df.apply(lambda row: get_specialist(row["Name"], row["Symptoms"], row["Treatments"]), axis=1)

print(df)

print(df.head())

df.to_csv('symptoms_specialists.csv', index=False)
from google.colab import files
files.download('symptoms_specialists.csv')

from google.colab import drive
drive.mount('/content/drive')

import pandas as pd
file_path='/content/drive/MyDrive/symptoms_specialists.csv'
df=pd.read_csv(file_path)
print(df.head())